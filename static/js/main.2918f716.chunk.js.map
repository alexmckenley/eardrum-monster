{"version":3,"sources":["SpotifyAPI.js","graphql/mutations.js","Auth.js","Header.js","DevPublisher.js","SpotifyWebPlayer.js","SpotifyContext.js","useSpotifyWebPlayer.js","SongPlayerWithControls.js","useSpotifyAPI.js","Track.js","TrackList.js","EQBars.js","graphql/queries.js","Listen.js","graphql/subscriptions.js","BroadcastPublisher.js","PowerHourControl.js","Broadcast.js","Channel.js","Home.js","App.js","serviceWorker.js","aws-exports.js","index.js","logo.png"],"names":["SpotifyAPI","accessToken","onUnauthorized","Error","this","maybeHandle401","bind","response","status","fetch","method","headers","Authorization","then","ok","json","console","error","data","device","id","uri","deviceID","query","body","JSON","stringify","uris","device_ids","play","createSongEvent","AuthContext","createContext","AuthRedirect","getAuthorizeURI","pathname","redirectURI","encodeURIComponent","process","currentPath","AuthProvider","children","useLocalStorage","authInfo","setAuthInfo","location","useLocation","history","useHistory","React","useEffect","hash","params","slice","split","map","param","forEach","tup","access_token","fetchUserInfo","user","username","push","decodeURIComponent","state","API","graphql","graphqlOperation","input","userID","catch","handleAuthRedirect","authContext","useMemo","logout","Provider","value","Header","useContext","authorizeURI","className","to","src","logo","alt","href","onClick","e","preventDefault","DevPublisher","hostUsername","timeoutID","setInterval","songEvent","timestamp","Math","floor","Date","now","position","spotifyURI","random","toString","mutations","log","clearInterval","SpotifyWebPlayer","player","spotifyAPI","getCurrentState","pause","ms","seek","nextTrack","callback","addListener","transferPlayback","Promise","resolve","window","Spotify","Player","onSpotifyWebPlaybackSDKReady","sdkScript","document","createElement","appendChild","__accessToken","__onUnauthorized","EMglobalPlayerInstance","EMGlobalPlayerInstance","name","getOAuthToken","cb","volume","on","message","device_id","connect","success","inject","initializePlayer","track_window","current_track","type","SpotifyContext","SpotifyProvider","useState","webPlayer","setWebPlayer","setSpotifyAPI","api","createInstance","inst","spotifyContext","useSpotifyWebPlayer","SongPlayerWithControls","song","useSpotifyAPI","spotifyWebPlayer","activeDeviceID","setActiveDeviceID","devices","setDevices","eardrumPlayer","getDeviceID","deviceList","find","d","fetchDevices","activeDevice","is_active","onChange","event","target","key","Track","track","albumImg","artistName","TrackList","songs","EQBars","songEventsByUserId","StartListening","isListening","ListenPlayer","isCurrentlyLive","setIsListening","noSleep","NoSleep","enable","disable","search","includes","replace","handleJoin","useCallback","Listen","devPublisherEnabled","Connect","queries","sortDirection","limit","subscription","onSubscriptionMsg","prev","onCreateSongEvent","songEventsByUserID","items","unshift","length","pop","loading","isRecent","BroadcastPublisher","currentTrack","onSongEvent","handlePlayerStateChangedRef","useRef","current","newState","newTrack","getTrackFromState","trackData","trackID","durationMs","duration_ms","albumName","album","artists","images","url","publishSongEvent","fetchState","onPlayerStateChanged","PowerHourControl","phEnabled","setPhEnabled","phCount","setPhCount","phCallbackRef","handleChange","enabled","htmlFor","checked","Broadcast","songHistory","setSongHistory","setCurrentTrack","handleSongEvent","h","concat","Channel","useParams","UserList","users","Home","onUserUpdate","listUsers","App","exact","path","Boolean","hostname","match","awsmobile","aws_project_region","aws_appsync_graphqlEndpoint","aws_appsync_region","aws_appsync_authenticationType","aws_appsync_apiKey","Amplify","configure","awsconfig","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports"],"mappings":"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","file":"static/js/main.2918f716.chunk.js","sourcesContent":["export default class SpotifyAPI {\n  constructor(accessToken, onUnauthorized) {\n    if (accessToken == null) {\n      throw new Error(\"Access token was null\");\n    }\n    this.accessToken = accessToken;\n    this.onUnauthorized = onUnauthorized ?? (() => {});\n    this.maybeHandle401 = this.maybeHandle401.bind(this);\n  }\n\n  maybeHandle401(response) {\n    if (response.status === 401) {\n      this.onUnauthorized();\n      throw new Error(\"Unauthorized: \", response);\n    }\n    return response;\n  }\n\n  fetchUserInfo() {\n    return fetch(\"https://api.spotify.com/v1/me\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.accessToken}`,\n      },\n    })\n      .then(this.maybeHandle401)\n      .then((response) => {\n        if (!response.ok) {\n          throw response;\n        }\n        return response.json();\n      });\n  }\n\n  fetchCurrentDeviceId() {\n    return fetch(\"https://api.spotify.com/v1/me/player\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.accessToken}`,\n      },\n    })\n      .then(this.maybeHandle401)\n      .then((response) => {\n        if (!response.ok) {\n          console.error(\"error fetching device id\");\n        }\n        if (response.status === 204) {\n          return null;\n        }\n        return response.json();\n      })\n      .then((data) => {\n        if (data?.device?.id) {\n          return data.device.id;\n        }\n        return null;\n      });\n  }\n\n  play(uri, deviceID) {\n    const query = deviceID != null ? `?device_id=${deviceID}` : \"\";\n    return fetch(`https://api.spotify.com/v1/me/player/play/${query}`, {\n      method: \"PUT\",\n      body: JSON.stringify({ uris: [uri] }),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.accessToken}`,\n      },\n    })\n      .then(this.maybeHandle401)\n      .then((response) => {\n        if (!response.ok) {\n          console.error(\"Error playing uri\", response);\n        }\n      });\n  }\n\n  transferPlayback(deviceID) {\n    return fetch(\"https://api.spotify.com/v1/me/player\", {\n      method: \"PUT\",\n      body: JSON.stringify({ device_ids: [deviceID], play: true }),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.accessToken}`,\n      },\n    })\n      .then(this.maybeHandle401)\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(\"unable to transfer playback to device: \" + deviceID);\n        }\n      });\n  }\n\n  fetchDevices() {\n    return fetch(\"https://api.spotify.com/v1/me/player/devices\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.accessToken}`,\n      },\n    })\n      .then(this.maybeHandle401)\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(\"unable to fetch devices\");\n        }\n        return response.json();\n      });\n  }\n}\n","/* eslint-disable */\n// this is an auto generated file. This will be overwritten\n\nexport const createUser = /* GraphQL */ `\n  mutation CreateUser(\n    $input: CreateUserInput!\n    $condition: ModelUserConditionInput\n  ) {\n    createUser(input: $input, condition: $condition) {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const updateUser = /* GraphQL */ `\n  mutation UpdateUser(\n    $input: UpdateUserInput!\n    $condition: ModelUserConditionInput\n  ) {\n    updateUser(input: $input, condition: $condition) {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const deleteUser = /* GraphQL */ `\n  mutation DeleteUser(\n    $input: DeleteUserInput!\n    $condition: ModelUserConditionInput\n  ) {\n    deleteUser(input: $input, condition: $condition) {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const createSongEvent = /* GraphQL */ `\n  mutation CreateSongEvent(\n    $input: CreateSongEventInput!\n    $condition: ModelSongEventConditionInput\n  ) {\n    createSongEvent(input: $input, condition: $condition) {\n      id\n      spotifyURI\n      timestamp\n      position\n      track {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      userID\n      user {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n    }\n  }\n`;\nexport const updateSongEvent = /* GraphQL */ `\n  mutation UpdateSongEvent(\n    $input: UpdateSongEventInput!\n    $condition: ModelSongEventConditionInput\n  ) {\n    updateSongEvent(input: $input, condition: $condition) {\n      id\n      spotifyURI\n      timestamp\n      position\n      track {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      userID\n      user {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n    }\n  }\n`;\nexport const deleteSongEvent = /* GraphQL */ `\n  mutation DeleteSongEvent(\n    $input: DeleteSongEventInput!\n    $condition: ModelSongEventConditionInput\n  ) {\n    deleteSongEvent(input: $input, condition: $condition) {\n      id\n      spotifyURI\n      timestamp\n      position\n      track {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      userID\n      user {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n    }\n  }\n`;\nexport const createTrack = /* GraphQL */ `\n  mutation CreateTrack(\n    $input: CreateTrackInput!\n    $condition: ModelTrackConditionInput\n  ) {\n    createTrack(input: $input, condition: $condition) {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\nexport const updateTrack = /* GraphQL */ `\n  mutation UpdateTrack(\n    $input: UpdateTrackInput!\n    $condition: ModelTrackConditionInput\n  ) {\n    updateTrack(input: $input, condition: $condition) {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\nexport const deleteTrack = /* GraphQL */ `\n  mutation DeleteTrack(\n    $input: DeleteTrackInput!\n    $condition: ModelTrackConditionInput\n  ) {\n    deleteTrack(input: $input, condition: $condition) {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\n","import React, { createContext } from \"react\";\nimport { useLocalStorage } from \"@rehooks/local-storage\";\nimport SpotifyAPI from \"./SpotifyAPI.js\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport { API, graphqlOperation } from \"aws-amplify\";\nimport * as mutations from \"./graphql/mutations\";\n\nexport const AuthContext = createContext();\n\nexport function AuthRedirect() {\n  return null;\n}\n\nexport function getAuthorizeURI(pathname) {\n  const clientID = process.env.REACT_APP_SPOTIFY_CLIENT_ID;\n  const scopes = process.env.REACT_APP_SPOTIFY_SCOPES;\n  const redirectURI = encodeURIComponent(\n    process.env.REACT_APP_SPOTIFY_REDIRECT_URI\n  );\n  const currentPath = encodeURIComponent(pathname);\n  return `https://accounts.spotify.com/authorize?response_type=token&client_id=${clientID}&scope=${scopes}&redirect_uri=${redirectURI}&state=${currentPath}`;\n}\n\nfunction handleAuthRedirect(setAuthInfo, history, location) {\n  if (location.hash) {\n    const params = {};\n    location.hash\n      .slice(1)\n      .split(\"&\")\n      .map((param) => param.split(\"=\"))\n      .forEach((tup) => {\n        params[tup[0]] = tup[1];\n      });\n    const accessToken = params.access_token;\n    if (accessToken == null) {\n      return;\n    }\n    location.hash = \"\";\n    new SpotifyAPI(accessToken).fetchUserInfo().then((user) => {\n      setAuthInfo({ accessToken, username: user.id });\n      history.push(decodeURIComponent(params.state));\n      // Ensure the user is created upon login\n      API.graphql(\n        graphqlOperation(mutations.createUser, {\n          input: {\n            userID: user.id,\n          },\n        })\n      ).catch(() => console.error(\"user creation failed\"));\n    });\n  }\n  return null;\n}\n\nexport function AuthProvider({ children }) {\n  const [authInfo, setAuthInfo] = useLocalStorage(\"EMAuthInfo\");\n  const location = useLocation();\n  const history = useHistory();\n\n  React.useEffect(() => {\n    handleAuthRedirect(setAuthInfo, history, location);\n  }, [setAuthInfo, history, location]);\n\n  const authContext = React.useMemo(() => {\n    return authInfo != null\n      ? {\n          accessToken: authInfo.accessToken,\n          username: authInfo.username,\n          logout: () => setAuthInfo(null),\n        }\n      : null;\n  }, [authInfo, setAuthInfo]);\n\n  return (\n    <AuthContext.Provider value={authContext}>{children}</AuthContext.Provider>\n  );\n}\n","import React from \"react\";\nimport logo from \"./logo.png\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { AuthContext, getAuthorizeURI } from \"./Auth.js\";\n\nfunction Header() {\n  const authInfo = React.useContext(AuthContext);\n  const location = useLocation();\n  const authorizeURI = getAuthorizeURI(location.pathname);\n\n  function handleLogout(e) {\n    e.preventDefault();\n    authInfo.logout();\n  }\n\n  return (\n    <header className=\"App-header\">\n      <Link className=\"App-title\" to=\"/\">\n        <h1>EARDRUM MONSTER</h1>\n      </Link>\n      <img src={logo} className=\"App-logo\" alt=\"logo\" />\n      {authInfo != null ? (\n        <>\n          <Link className=\"App-link\" to={`/u/${authInfo.username}`}>\n            /u/{authInfo.username}\n          </Link>\n          {/* eslint-disable-next-line jsx-a11y/anchor-is-valid */}\n          <a className=\"App-link\" href=\"#\" onClick={handleLogout}>\n            Logout\n          </a>\n        </>\n      ) : (\n        <a className=\"App-link\" href={authorizeURI}>\n          Login with Spotify\n        </a>\n      )}\n    </header>\n  );\n}\n\nexport default Header;\n","import React from \"react\";\nimport { API, graphqlOperation } from \"aws-amplify\";\nimport * as mutations from \"./graphql/mutations\";\n\nexport default function DevPublisher({ hostUsername }) {\n  React.useEffect(() => {\n    const timeoutID = setInterval(() => {\n      const tracks = [\n        \"spotify:track:08KMh61hPslT7sEf2tEgtT\",\n        \"spotify:track:4mFDsq9pt9msJ9ywYvBzHo\",\n        \"spotify:track:59nNxS2V7M4UDH058BU5qJ\",\n        \"spotify:track:1CkrhTdtRhUzPmA8qtr6y6\",\n        \"spotify:track:4mFDsq9pt9msJ9ywYvBzHo\",\n        \"spotify:track:6AynxUt8LJy9S6bovDdFLr\",\n        \"spotify:track:000PzErbB04ALQCv9iYiQm\",\n        \"spotify:track:6AynxUt8LJy9S6bovDdFLr\",\n        \"spotify:track:7JGepQzDnQDYeGxLCTBSsG\",\n        \"spotify:track:4PPrsYpzuRqe4QoCDGAG4b\",\n      ];\n      const songEvent = {\n        userID: hostUsername,\n        timestamp: Math.floor(Date.now() / 100),\n        position: 0,\n        spotifyURI: tracks[(Math.random() * 100).toString()[0]],\n      };\n      API.graphql(\n        graphqlOperation(mutations.createSongEvent, { input: songEvent })\n      ).then((data) => console.log(\"Publishing: \", data));\n    }, 5000);\n\n    return () => {\n      clearInterval(timeoutID);\n    };\n  }, [hostUsername]);\n\n  return <h1>DevPublisher enabled</h1>;\n}\n","export default class SpotifyWebPlayer {\n  constructor(player, spotifyAPI) {\n    this.player = player;\n    this.spotifyAPI = spotifyAPI;\n  }\n\n  fetchState() {\n    return this.player.getCurrentState();\n  }\n\n  pause() {\n    return this.player.pause();\n  }\n\n  seek(ms) {\n    return this.player.seek(ms);\n  }\n\n  nextTrack() {\n    return this.player.nextTrack();\n  }\n\n  onPlayerStateChanged(callback) {\n    this.player.addListener(\"player_state_changed\", callback);\n  }\n\n  getDeviceID() {\n    return this.player.deviceID;\n  }\n\n  transferPlayback() {\n    return this.spotifyAPI.transferPlayback(this.player.deviceID);\n  }\n\n  static inject() {\n    return new Promise((resolve) => {\n      if (window?.Spotify?.Player) {\n        resolve();\n        return;\n      }\n      window.onSpotifyWebPlaybackSDKReady = () => {\n        resolve();\n      };\n      const sdkScript = document.createElement(\"script\");\n      sdkScript.src = \"https://sdk.scdn.co/spotify-player.js\";\n      document.body.appendChild(sdkScript);\n    });\n  }\n\n  static initializePlayer(accessToken, onUnauthorized) {\n    // Update accessToken singleton so existing players can access it;\n    SpotifyWebPlayer.__accessToken = accessToken;\n    SpotifyWebPlayer.__onUnauthorized = onUnauthorized;\n\n    return new Promise((resolve) => {\n      if (window.EMglobalPlayerInstance) {\n        resolve(window.EMGlobalPlayerInstance);\n        return;\n      }\n\n      const player = new window.Spotify.Player({\n        name: \"eardrum.monster\",\n        getOAuthToken: (cb) => cb(SpotifyWebPlayer.__accessToken),\n        volume: 0.1,\n      });\n\n      player.on(\"initialization_error\", ({ message }) => {\n        console.error(\"Failed to initialize\", message);\n      });\n      player.on(\"authentication_error\", ({ message }) => {\n        console.error(\"Failed to authenticate\", message);\n        SpotifyWebPlayer.__onUnauthorized();\n      });\n      player.on(\"account_error\", ({ message }) => {\n        console.error(\"Failed to validate Spotify account\", message);\n      });\n      player.on(\"playback_error\", ({ message }) => {\n        console.error(\"Failed to perform playback\", message);\n      });\n      player.on(\"ready\", ({ device_id: id }) => {\n        player.deviceID = id;\n        window.EMGlobalPlayerInstance = player;\n        resolve(player);\n      });\n\n      player.connect().then((success) => {\n        if (!success) {\n          console.error(\"Failed to connect to the web player\");\n        }\n      });\n    });\n  }\n\n  static createInstance(accessToken, spotifyAPI, onUnauthorized) {\n    return SpotifyWebPlayer.inject()\n      .then(() =>\n        SpotifyWebPlayer.initializePlayer(accessToken, onUnauthorized)\n      )\n      .then((player) => new SpotifyWebPlayer(player, spotifyAPI));\n  }\n\n  static getTrackFromState(state) {\n    return state?.track_window?.current_track;\n  }\n\n  static isAd(state) {\n    return state?.track_window?.current_track?.type === \"ad\";\n  }\n}\n","import React, { createContext } from \"react\";\nimport SpotifyAPI from \"./SpotifyAPI.js\";\nimport SpotifyWebPlayer from \"./SpotifyWebPlayer.js\";\nimport { AuthContext } from \"./Auth.js\";\n\nexport const SpotifyContext = createContext();\n\nexport function SpotifyProvider({ children }) {\n  const authInfo = React.useContext(AuthContext);\n  const [webPlayer, setWebPlayer] = React.useState(null);\n  const [spotifyAPI, setSpotifyAPI] = React.useState(null);\n\n  React.useEffect(() => {\n    if (authInfo == null) {\n      setWebPlayer(null);\n      setSpotifyAPI(null);\n    } else {\n      const api = new SpotifyAPI(authInfo.accessToken, authInfo.logout);\n      setSpotifyAPI(api);\n      SpotifyWebPlayer.createInstance(\n        authInfo.accessToken,\n        api,\n        authInfo.logout\n      ).then((inst) => {\n        setWebPlayer(inst);\n      });\n    }\n  }, [authInfo]);\n\n  const spotifyContext = React.useMemo(\n    () => ({\n      webPlayer,\n      spotifyAPI,\n    }),\n    [webPlayer, spotifyAPI]\n  );\n\n  return (\n    <SpotifyContext.Provider value={spotifyContext}>\n      {children}\n    </SpotifyContext.Provider>\n  );\n}\n","import React from \"react\";\nimport { SpotifyContext } from \"./SpotifyContext.js\";\n\nexport default function useSpotifyWebPlayer() {\n  const spotifyContext = React.useContext(SpotifyContext);\n  return spotifyContext?.webPlayer;\n}\n","import React from \"react\";\nimport useSpotifyAPI from \"./useSpotifyAPI.js\";\nimport useSpotifyWebPlayer from \"./useSpotifyWebPlayer.js\";\n\nexport default function SongPlayerWithControls({ song }) {\n  const spotifyAPI = useSpotifyAPI();\n  const spotifyWebPlayer = useSpotifyWebPlayer();\n  const [activeDeviceID, setActiveDeviceID] = React.useState(null);\n  const [devices, setDevices] = React.useState(null);\n\n  const eardrumPlayer = spotifyWebPlayer && {\n    id: spotifyWebPlayer.getDeviceID(),\n    name: \"eardrum.monster\",\n  };\n  const deviceList = devices ?? [];\n  if (\n    eardrumPlayer != null &&\n    !deviceList.find((d) => d.id === eardrumPlayer.id)\n  ) {\n    deviceList.push(eardrumPlayer);\n  }\n\n  // Fetch devices\n  React.useEffect(() => {\n    spotifyAPI &&\n      spotifyAPI.fetchDevices().then((data) => {\n        setDevices(data.devices);\n      });\n  }, [spotifyAPI]);\n\n  // Use web player if there is no active device\n  React.useEffect(() => {\n    if (spotifyAPI && devices) {\n      const activeDevice = devices.find((device) => device.is_active === true);\n      if (activeDevice) {\n        setActiveDeviceID(activeDevice.id);\n        return;\n      } else if (spotifyWebPlayer) {\n        setActiveDeviceID(spotifyWebPlayer.getDeviceID());\n      }\n    }\n  }, [spotifyAPI, devices, spotifyWebPlayer]);\n\n  React.useEffect(() => {\n    activeDeviceID &&\n      spotifyAPI &&\n      spotifyAPI.play(song.spotifyURI, activeDeviceID);\n  }, [spotifyAPI, activeDeviceID, song]);\n\n  const handleChange = (event) => {\n    setActiveDeviceID(event.target.value);\n  };\n\n  return (\n    <div className=\"Listen-controls\">\n      <div>Playing on device:</div>\n      <select value={activeDeviceID ?? \"\"} onChange={handleChange}>\n        {deviceList?.map((device) => (\n          <option key={device.id} value={device.id}>\n            {device.name}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { SpotifyContext } from \"./SpotifyContext.js\";\n\nexport default function useSpotifyAPI() {\n  const spotifyContext = React.useContext(SpotifyContext);\n  return spotifyContext?.spotifyAPI;\n}\n","import React from \"react\";\nimport \"./Track.css\";\nimport logo from \"./logo.png\";\n\nfunction Track({ track }) {\n  return (\n    <div className=\"Track\">\n      <img\n        className=\"Track-albumImg\"\n        src={track?.albumImg ?? logo}\n        alt=\"Album art\"\n      />\n      <div className=\"Track-details\">\n        <p className=\"Track-name\">{track?.name ?? \"Unknown\"}</p>\n        <p className=\"Track-artist\">{track?.artistName}</p>\n      </div>\n    </div>\n  );\n}\n\nexport default Track;\n","import React from \"react\";\nimport Track from \"./Track.js\";\n\nexport default function TrackList({ songs }) {\n  return (\n    <>\n      <h3>Recently played tracks</h3>\n      {songs.map((song) => (\n        <div key={song.id} className=\"Listen-track\">\n          <Track track={song.track} />\n        </div>\n      ))}\n    </>\n  );\n}\n","import React from \"react\";\nimport \"./EQBars.css\";\n\nexport default function EQBars({ className }) {\n  return (\n    <div className={className}>\n      <div className=\"EQBars-container\">\n        <ol className=\"EQBars-column\">\n          <li className=\"colour-bar\"></li>\n        </ol>\n        <ol className=\"EQBars-column\">\n          <li className=\"colour-bar\"></li>\n        </ol>\n        <ol className=\"EQBars-column\">\n          <li className=\"colour-bar\"></li>\n        </ol>\n        <ol className=\"EQBars-column\">\n          <li className=\"colour-bar\"></li>\n        </ol>\n        <ol className=\"EQBars-column\">\n          <li className=\"colour-bar\"></li>\n        </ol>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable */\n// this is an auto generated file. This will be overwritten\n\nexport const getUser = /* GraphQL */ `\n  query GetUser($userID: String!) {\n    getUser(userID: $userID) {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const listUsers = /* GraphQL */ `\n  query ListUsers(\n    $userID: String\n    $filter: ModelUserFilterInput\n    $limit: Int\n    $nextToken: String\n    $sortDirection: ModelSortDirection\n  ) {\n    listUsers(\n      userID: $userID\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n      sortDirection: $sortDirection\n    ) {\n      items {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n      nextToken\n    }\n  }\n`;\nexport const getSongEvent = /* GraphQL */ `\n  query GetSongEvent($id: ID!) {\n    getSongEvent(id: $id) {\n      id\n      spotifyURI\n      timestamp\n      position\n      track {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      userID\n      user {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n    }\n  }\n`;\nexport const listSongEvents = /* GraphQL */ `\n  query ListSongEvents(\n    $filter: ModelSongEventFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listSongEvents(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        spotifyURI\n        timestamp\n        position\n        track {\n          uri\n          trackID\n          name\n          durationMs\n          albumName\n          artistName\n          albumImg\n        }\n        userID\n        user {\n          userID\n          latestEvent\n        }\n      }\n      nextToken\n    }\n  }\n`;\nexport const getTrack = /* GraphQL */ `\n  query GetTrack($uri: String!) {\n    getTrack(uri: $uri) {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\nexport const listTracks = /* GraphQL */ `\n  query ListTracks(\n    $uri: String\n    $filter: ModelTrackFilterInput\n    $limit: Int\n    $nextToken: String\n    $sortDirection: ModelSortDirection\n  ) {\n    listTracks(\n      uri: $uri\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n      sortDirection: $sortDirection\n    ) {\n      items {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      nextToken\n    }\n  }\n`;\nexport const songEventsByUserId = /* GraphQL */ `\n  query SongEventsByUserId(\n    $userID: String\n    $timestamp: ModelIntKeyConditionInput\n    $sortDirection: ModelSortDirection\n    $filter: ModelSongEventFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    songEventsByUserID(\n      userID: $userID\n      timestamp: $timestamp\n      sortDirection: $sortDirection\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        spotifyURI\n        timestamp\n        position\n        track {\n          uri\n          trackID\n          name\n          durationMs\n          albumName\n          artistName\n          albumImg\n        }\n        userID\n        user {\n          userID\n          latestEvent\n        }\n      }\n      nextToken\n    }\n  }\n`;\n","import React from \"react\";\nimport { graphqlOperation } from \"aws-amplify\";\nimport { Connect } from \"aws-amplify-react\";\nimport \"./Listen.css\";\nimport DevPublisher from \"./DevPublisher.js\";\nimport { AuthContext, getAuthorizeURI } from \"./Auth.js\";\nimport SongPlayerWithControls from \"./SongPlayerWithControls.js\";\nimport TrackList from \"./TrackList.js\";\nimport Track from \"./Track.js\";\nimport EQBars from \"./EQBars.js\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport NoSleep from \"nosleep.js\";\n\nimport * as queries from \"./graphql/queries\";\nimport * as subscriptions from \"./graphql/subscriptions\";\n\nfunction StartListening({ children, isListening, onClick }) {\n  const location = useLocation();\n  const authInfo = React.useContext(AuthContext);\n\n  if (isListening) {\n    return children;\n  }\n\n  return (\n    <div className=\"Listen-startListening\">\n      <div className=\"Listen-startListeningMask\">{children}</div>\n      <div className=\"Listen-startListeningContent\">\n        <EQBars className=\"Listen-EQ\" />\n      </div>\n      <div className=\"Listen-startListeningContent\">\n        <a\n          className=\"Listen-play\"\n          href={\n            authInfo == null\n              ? getAuthorizeURI(location.pathname + \"?join=true\")\n              : location.pathname\n          }\n          onClick={authInfo ? onClick : null}\n        >\n          {/* eslint-disable-next-line jsx-a11y/accessible-emoji */}\n          👂\n          <span className=\"Listen-playLink\">\n            {authInfo == null ? \"Login to join ▶\" : \"Join ▶\"}\n          </span>\n          {/* eslint-disable-next-line jsx-a11y/accessible-emoji */}\n          😈\n        </a>\n      </div>\n    </div>\n  );\n}\n\nfunction ListenPlayer({ isCurrentlyLive, songs, hostUsername }) {\n  const authInfo = React.useContext(AuthContext);\n  const location = useLocation();\n  const history = useHistory();\n  const [isListening, setIsListening] = React.useState(false);\n\n  React.useEffect(() => {\n    if (isListening) {\n      const noSleep = new NoSleep();\n      noSleep.enable();\n      console.log(\"enabling\");\n      return () => noSleep.disable();\n    }\n  }, [isListening]);\n\n  React.useEffect(() => {\n    if (authInfo && location.search.includes(\"join=true\")) {\n      setIsListening(true);\n      history.replace(location.pathname);\n    }\n  }, [authInfo, history, location]);\n\n  const handleJoin = React.useCallback(\n    (e) => {\n      e.preventDefault();\n      setIsListening(true);\n    },\n    [setIsListening]\n  );\n\n  if (!isCurrentlyLive) {\n    return <div>User is offline</div>;\n  }\n\n  return (\n    <StartListening isListening={isListening} onClick={handleJoin}>\n      {isListening && <p>Listening to {hostUsername}'s channel!</p>}\n      {isListening && <SongPlayerWithControls song={songs[0]} />}\n      <div>Now Playing:</div>\n      <Track track={songs[0].track} />\n    </StartListening>\n  );\n}\n\nfunction Listen({ hostUsername }) {\n  const location = useLocation();\n  const devPublisherEnabled = location.search.includes(\"DEV=1\");\n\n  return (\n    <div className=\"Listen\">\n      <div className=\"Listen-header\">\n        {devPublisherEnabled && <DevPublisher hostUsername={hostUsername} />}\n      </div>\n\n      <div className=\"Listen-trackList\">\n        <Connect\n          query={graphqlOperation(queries.songEventsByUserId, {\n            userID: hostUsername,\n            sortDirection: \"DESC\",\n            limit: 50,\n          })}\n          subscription={graphqlOperation(subscriptions.onCreateSongEvent, {\n            userID: hostUsername,\n          })}\n          onSubscriptionMsg={(prev, { onCreateSongEvent }) => {\n            prev.songEventsByUserID.items.unshift(onCreateSongEvent);\n            if (prev.songEventsByUserID.items.length > 50) {\n              prev.songEventsByUserID.items.pop();\n            }\n            return prev;\n          }}\n        >\n          {({ data, loading, error }) => {\n            if (error) return <h3>Error</h3>;\n            if (loading || !data) return <h3>Loading...</h3>;\n            const songs =\n              (data.songEventsByUserID && data.songEventsByUserID.items) ?? [];\n            if (songs.length === 0) {\n              return <div>No track history available</div>;\n            }\n            const isRecent =\n              Math.floor(Date.now() / 1000) - songs[0].timestamp < 600; // 10 minutes in seconds\n            return (\n              <>\n                <ListenPlayer\n                  isCurrentlyLive={isRecent}\n                  songs={songs}\n                  hostUsername={hostUsername}\n                />\n                <TrackList songs={isRecent ? songs.slice(1) : songs} />\n              </>\n            );\n          }}\n        </Connect>\n      </div>\n    </div>\n  );\n}\n\nexport default Listen;\n","/* eslint-disable */\n// this is an auto generated file. This will be overwritten\n\nexport const onCreateSongEvent = /* GraphQL */ `\n  subscription OnCreateSongEvent($userID: String!) {\n    onCreateSongEvent(userID: $userID) {\n      id\n      spotifyURI\n      timestamp\n      position\n      track {\n        uri\n        trackID\n        name\n        durationMs\n        albumName\n        artistName\n        albumImg\n      }\n      userID\n      user {\n        userID\n        latestEvent\n        songEvents {\n          nextToken\n        }\n      }\n    }\n  }\n`;\nexport const onCreateUser = /* GraphQL */ `\n  subscription OnCreateUser {\n    onCreateUser {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const onUpdateUser = /* GraphQL */ `\n  subscription OnUpdateUser {\n    onUpdateUser {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const onDeleteUser = /* GraphQL */ `\n  subscription OnDeleteUser {\n    onDeleteUser {\n      userID\n      latestEvent\n      songEvents {\n        items {\n          id\n          spotifyURI\n          timestamp\n          position\n          userID\n        }\n        nextToken\n      }\n    }\n  }\n`;\nexport const onCreateTrack = /* GraphQL */ `\n  subscription OnCreateTrack {\n    onCreateTrack {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\nexport const onUpdateTrack = /* GraphQL */ `\n  subscription OnUpdateTrack {\n    onUpdateTrack {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\nexport const onDeleteTrack = /* GraphQL */ `\n  subscription OnDeleteTrack {\n    onDeleteTrack {\n      uri\n      trackID\n      name\n      durationMs\n      albumName\n      artistName\n      albumImg\n    }\n  }\n`;\n","import React from \"react\";\nimport { API, graphqlOperation } from \"aws-amplify\";\nimport * as mutations from \"./graphql/mutations\";\nimport useSpotifyWebPlayer from \"./useSpotifyWebPlayer.js\";\nimport SpotifyWebPlayer from \"./SpotifyWebPlayer.js\";\nimport { AuthContext } from \"./Auth.js\";\n\nfunction publishSongEvent(songEvent) {\n  return API.graphql(\n    graphqlOperation(mutations.createSongEvent, {\n      input: songEvent,\n    })\n  );\n}\n\nfunction publishTrack(track) {\n  return API.graphql(graphqlOperation(mutations.createTrack, { input: track }));\n}\n\nexport default function BroadcastPublisher({ currentTrack, onSongEvent }) {\n  const authInfo = React.useContext(AuthContext);\n  const spotifyWebPlayer = useSpotifyWebPlayer();\n  const handlePlayerStateChangedRef = React.useRef(null);\n\n  const handlePlayerStateChanged = (newState) => {\n    const newTrack = SpotifyWebPlayer.getTrackFromState(newState);\n    // Avoid updating if track is the same\n    if (newTrack == null || newTrack.uri === currentTrack.uri) {\n      return;\n    }\n    const songEvent = {\n      userID: authInfo.username,\n      timestamp: Math.floor(Date.now() / 1000),\n      position: Math.floor(newState.position ?? 0),\n      spotifyURI: newTrack.uri,\n    };\n    const trackData = {\n      uri: newTrack.uri,\n      trackID: newTrack.id,\n      name: newTrack.name,\n      durationMs: newTrack.duration_ms,\n      albumName: newTrack.album.name,\n      artistName: newTrack.artists[0].name,\n      albumImg: newTrack.album.images[0].url,\n    };\n    onSongEvent(trackData, songEvent);\n    publishTrack(trackData).then(() => publishSongEvent(songEvent));\n  };\n  handlePlayerStateChangedRef.current = handlePlayerStateChanged;\n\n  React.useEffect(() => {\n    if (spotifyWebPlayer) {\n      // Request the initial state\n      spotifyWebPlayer\n        .fetchState()\n        .then((newState) => handlePlayerStateChangedRef.current(newState));\n      // Subscribe to future changes\n      spotifyWebPlayer.onPlayerStateChanged((newState) =>\n        handlePlayerStateChangedRef.current(newState)\n      );\n      // Transfer playback to the web player\n      spotifyWebPlayer.transferPlayback();\n    }\n  }, [spotifyWebPlayer, handlePlayerStateChangedRef]);\n\n  return null;\n}\n","import React from \"react\";\nimport Switch from \"react-switch\";\nimport useSpotifyWebPlayer from \"./useSpotifyWebPlayer.js\";\nimport { useLocalStorage } from \"@rehooks/local-storage\";\n\nexport default function PowerHourControl() {\n  const [phEnabled, setPhEnabled] = useLocalStorage(\"EMPhEnabled\", false);\n  const [phCount, setPhCount] = useLocalStorage(\"EMPhCount\", 1);\n  const spotifyWebPlayer = useSpotifyWebPlayer();\n  const phCallbackRef = React.useRef();\n\n  const phCallback = (timeoutID) => {\n    if (phEnabled) {\n      spotifyWebPlayer.nextTrack();\n      setPhCount(phCount + 1);\n    } else {\n      clearInterval(timeoutID);\n    }\n  };\n  phCallbackRef.current = phCallback;\n\n  const handleChange = React.useCallback(\n    (enabled) => {\n      setPhEnabled(enabled);\n      if (enabled) {\n        setPhCount(1);\n        spotifyWebPlayer && spotifyWebPlayer.nextTrack();\n      }\n    },\n    [setPhEnabled, setPhCount, spotifyWebPlayer]\n  );\n\n  React.useEffect(() => {\n    if (phEnabled && spotifyWebPlayer) {\n      const timeoutID = setInterval(() => {\n        phCallbackRef.current(timeoutID);\n      }, 60000);\n      return () => {\n        clearInterval(timeoutID);\n      };\n    }\n  }, [phEnabled, spotifyWebPlayer, phCallbackRef]);\n\n  return (\n    <>\n      <div className=\"Broadcast-controls\">\n        <label htmlFor=\"phToggle\">Power hour mode</label>\n        <Switch\n          className=\"Broadcast-switch\"\n          id=\"phToggle\"\n          onChange={handleChange}\n          checked={phEnabled}\n        />\n      </div>\n      {phEnabled && <h1>{phCount}</h1>}\n    </>\n  );\n}\n","import React from \"react\";\nimport { API, graphqlOperation } from \"aws-amplify\";\nimport * as queries from \"./graphql/queries\";\nimport useSpotifyWebPlayer from \"./useSpotifyWebPlayer.js\";\nimport Track from \"./Track.js\";\nimport TrackList from \"./TrackList.js\";\nimport \"./Broadcast.css\";\nimport { AuthContext } from \"./Auth.js\";\nimport BroadcastPublisher from \"./BroadcastPublisher.js\";\nimport PowerHourControl from \"./PowerHourControl.js\";\n\nfunction Broadcast() {\n  const authInfo = React.useContext(AuthContext);\n  const [songHistory, setSongHistory] = React.useState(null);\n  const [currentTrack, setCurrentTrack] = React.useState(null);\n  const spotifyWebPlayer = useSpotifyWebPlayer();\n\n  const handleSongEvent = React.useCallback(\n    (track, songEvent) => {\n      setSongHistory((h) =>\n        [{ ...songEvent, track, id: Math.random() }].concat(h)\n      );\n      setCurrentTrack(track);\n    },\n    [setSongHistory, setCurrentTrack]\n  );\n\n  React.useEffect(() => {\n    if (authInfo) {\n      API.graphql(\n        graphqlOperation(queries.songEventsByUserId, {\n          userID: authInfo.username,\n          sortDirection: \"DESC\",\n          limit: 10,\n        })\n      ).then((response) => {\n        setSongHistory(response.data?.songEventsByUserID?.items ?? []);\n      });\n    }\n  }, [authInfo]);\n\n  if (authInfo == null) {\n    return <div>Login to spotify to set the eardrum monster free</div>;\n  }\n\n  if (spotifyWebPlayer == null || songHistory == null) {\n    return <div className=\"Broadcast\">Initializing...</div>;\n  }\n\n  return (\n    <div className=\"Broadcast\">\n      <PowerHourControl spotifyWebPlayer={spotifyWebPlayer} />\n      <h1>Connected.</h1>\n      <p>Now Playing:</p>\n      <div className=\"Broadcast-currentTrack\">\n        <BroadcastPublisher\n          currentTrack={currentTrack ?? songHistory[0].track}\n          onSongEvent={handleSongEvent}\n        />\n        <Track track={currentTrack ?? songHistory[0].track} />\n      </div>\n      <div className=\"Broadcast-history\">\n        <TrackList songs={songHistory.slice(1)} />\n      </div>\n    </div>\n  );\n}\n\nexport default Broadcast;\n","import React from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport Listen from \"./Listen.js\";\nimport Broadcast from \"./Broadcast.js\";\nimport { AuthContext } from \"./Auth.js\";\n\nfunction Channel() {\n  const authInfo = React.useContext(AuthContext);\n  const { id } = useParams();\n\n  if (authInfo?.username === id) {\n    return <Broadcast />;\n  }\n\n  return <Listen hostUsername={id} />;\n}\n\nexport default Channel;\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { graphqlOperation } from \"aws-amplify\";\nimport { Connect } from \"aws-amplify-react\";\nimport \"./Home.css\";\n\nimport * as queries from \"./graphql/queries\";\nimport * as subscriptions from \"./graphql/subscriptions\";\n\nconst UserList = ({ users }) => (\n  <ul className=\"Home-userList\">\n    {users.map((user) => (\n      <li key={user.userID}>\n        <Link className=\"Home-link\" to={`/u/${user.userID}`}>\n          {/* eslint-disable-next-line jsx-a11y/accessible-emoji */}\n          👂 /u/{user.userID}\n        </Link>\n      </li>\n    ))}\n  </ul>\n);\n\nfunction Home() {\n  return (\n    <div className=\"Home\">\n      <Connect\n        query={graphqlOperation(queries.listUsers, {\n          limit: 20,\n        })}\n        subscription={graphqlOperation(subscriptions.onUpdateUser)}\n        onSubscriptionMsg={(prev, { onUserUpdate }) => {\n          // TODO update user list here\n          return prev;\n        }}\n      >\n        {({ data, loading, error }) => {\n          if (error) return <h3>Error</h3>;\n          if (loading || !data) return <h3>Loading...</h3>;\n          const users = (data.listUsers && data.listUsers.items) ?? [];\n          return (\n            <>\n              {/* eslint-disable-next-line jsx-a11y/accessible-emoji */}\n              <h2>😈 MONSTER LIST 😈</h2>\n              <UserList users={users} />\n            </>\n          );\n        }}\n      </Connect>\n    </div>\n  );\n}\n\nexport default Home;\n","import React from \"react\";\nimport \"./App.css\";\nimport Header from \"./Header.js\";\nimport Channel from \"./Channel.js\";\nimport Home from \"./Home.js\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport { AuthProvider, AuthRedirect } from \"./Auth.js\";\nimport { SpotifyProvider } from \"./SpotifyContext.js\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router>\n        <AuthProvider>\n          <SpotifyProvider>\n            <Header />\n            <div className=\"App-content\">\n              <Switch>\n                <Route exact path=\"/\">\n                  <Home />\n                </Route>\n                <Route path=\"/auth/\">\n                  <AuthRedirect />\n                </Route>\n                <Route path=\"/u/:id\">\n                  <Channel />\n                </Route>\n              </Switch>\n            </div>\n          </SpotifyProvider>\n        </AuthProvider>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.\n\nconst awsmobile = {\n  aws_project_region: \"us-east-1\",\n  aws_appsync_graphqlEndpoint:\n    \"https://kponrlcw6jap7j62gb56h2abf4.appsync-api.us-east-1.amazonaws.com/graphql\",\n  aws_appsync_region: \"us-east-1\",\n  aws_appsync_authenticationType: \"API_KEY\",\n  aws_appsync_apiKey: \"da2-jxgfvq7zzvacfozrt7vucdiipq\",\n};\n\nexport default awsmobile;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport awsconfig from \"./aws-exports\";\nimport Amplify from \"aws-amplify\";\n\nAmplify.configure(awsconfig);\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/logo.86828523.png\";"],"sourceRoot":""}